import{_ as F,R as K,u as P,o as z,S as G,k as J,r as b,x as a,K as _,N as s,A as d,z as e,L as $,M as C,J as w,y as l}from"./CJyfR92X.js";import{u as M}from"./BWCIqgjc.js";import{u as O}from"./BvFTaLxf.js";const Y={class:"container"},j={key:0,class:"loading"},Q={key:1,class:"error"},W={key:2},X={class:"view-container"},Z={class:"post-info"},tt={class:"info-item"},et={class:"info-item"},st={class:"info-item"},ot={class:"content-box"},nt=["innerHTML"],at={class:"button-group"},lt={key:1,class:"nav-btn",disabled:""},rt={key:3,class:"nav-btn",disabled:""},it={key:0,class:"action-buttons"},dt={key:3,class:"edit-container"},ut={class:"form-group"},ct={class:"form-group"},vt={key:0,class:"error-message"},pt={class:"button-group"},bt=["disabled"],ft={class:"modal-buttons"},mt={__name:"[id]",async setup(_t){let f,y;const k=K(),m=P(),x=M("user_id");z(()=>{M("auth_token").value||m.push("/")});const{data:n,pending:D,error:g,refresh:S}=([f,y]=G(()=>O(`/api/board/${k.params.id}`,"$ILpk7GLwbK")),f=await f,y(),f),E=J(()=>!n.value||!n.value.data?!1:n.value.data.userid===x.value),c=b(!1),v=b(!1),p=b(!1),u=b(""),i=b({title:"",content:""}),L=()=>{i.value.title=n.value.data.title,i.value.content=n.value.data.content,c.value=!0},T=()=>{c.value=!1,u.value=""},U=async()=>{if(!p.value){p.value=!0,u.value="";try{const o=await $fetch(`/api/board/${k.params.id}`,{method:"PUT",body:i.value});o.success?(alert("게시물이 수정되었습니다."),c.value=!1,S()):u.value=o.error||"게시물 수정에 실패했습니다."}catch(o){console.error("Update error:",o),u.value="게시물 수정 중 오류가 발생했습니다."}finally{p.value=!1}}},V=async()=>{try{const o=await $fetch(`/api/board/${k.params.id}`,{method:"DELETE"});o.success?(alert("게시물이 삭제되었습니다."),m.push("/")):alert(o.error||"게시물 삭제에 실패했습니다.")}catch(o){console.error("Delete error:",o),alert("게시물 삭제 중 오류가 발생했습니다.")}finally{v.value=!1}},B=()=>{m.push("/board/list")},h=o=>{m.push(`/board/${o}`)},H=o=>{if(!o)return"";const t=new Date(o),r=t.getFullYear(),N=String(t.getMonth()+1).padStart(2,"0"),R=String(t.getDate()).padStart(2,"0"),q=String(t.getHours()).padStart(2,"0"),A=String(t.getMinutes()).padStart(2,"0");return`${r}-${N}-${R} ${q}:${A}`},I=o=>o?o.replace(/\n/g,"<br>"):"";return(o,t)=>(l(),a("div",Y,[s(D)?(l(),a("div",j," 데이터를 불러오는 중... ")):s(g)?(l(),a("div",Q," 오류가 발생했습니다: "+d(s(g).message),1)):!s(c)&&s(n)&&s(n).success?(l(),a("div",W,[e("div",X,[e("h1",null,d(s(n).data.title),1),e("div",Z,[e("div",tt,[t[8]||(t[8]=e("span",{class:"label"},"작성자:",-1)),e("span",null,d(s(n).data.writer),1)]),e("div",et,[t[9]||(t[9]=e("span",{class:"label"},"작성일:",-1)),e("span",null,d(H(s(n).data.regDate)),1)]),e("div",st,[t[10]||(t[10]=e("span",{class:"label"},"조회수:",-1)),e("span",null,d(s(n).data.hitno),1)])]),e("div",ot,[e("div",{class:"content",innerHTML:I(s(n).data.content)},null,8,nt)]),e("div",at,[s(n).prev?(l(),a("button",{key:0,onClick:t[0]||(t[0]=r=>h(s(n).prev.bno)),class:"nav-btn"}," ← 이전 게시물 ")):(l(),a("button",lt,"← 이전 게시물")),e("button",{onClick:B,class:"list-btn"}," 목록 "),s(n).next?(l(),a("button",{key:2,onClick:t[1]||(t[1]=r=>h(s(n).next.bno)),class:"nav-btn"}," 다음 게시물 → ")):(l(),a("button",rt,"다음 게시물 →"))]),s(E)?(l(),a("div",it,[e("button",{onClick:L,class:"edit-btn"}," 수정 "),e("button",{onClick:t[2]||(t[2]=r=>v.value=!0),class:"delete-btn"}," 삭제 ")])):_("",!0)])])):s(c)?(l(),a("div",dt,[t[13]||(t[13]=e("h1",null,"게시물 수정",-1)),e("form",{onSubmit:w(U,["prevent"]),class:"edit-form"},[e("div",ut,[t[11]||(t[11]=e("label",{for:"title"},"제목 *",-1)),$(e("input",{type:"text",id:"title","onUpdate:modelValue":t[3]||(t[3]=r=>s(i).title=r),required:""},null,512),[[C,s(i).title]])]),e("div",ct,[t[12]||(t[12]=e("label",{for:"content"},"내용 *",-1)),$(e("textarea",{id:"content","onUpdate:modelValue":t[4]||(t[4]=r=>s(i).content=r),rows:"15",required:""},null,512),[[C,s(i).content]])]),s(u)?(l(),a("div",vt,d(s(u)),1)):_("",!0),e("div",pt,[e("button",{type:"submit",class:"submit-btn",disabled:s(p)},d(s(p)?"수정 중...":"수정"),9,bt),e("button",{type:"button",onClick:T,class:"cancel-btn"}," 취소 ")])],32)])):_("",!0),s(v)?(l(),a("div",{key:4,class:"modal-overlay",onClick:t[7]||(t[7]=r=>v.value=!1)},[e("div",{class:"modal-content",onClick:t[6]||(t[6]=w(()=>{},["stop"]))},[t[14]||(t[14]=e("h2",null,"게시물 삭제",-1)),t[15]||(t[15]=e("p",null,"정말로 이 게시물을 삭제하시겠습니까?",-1)),e("div",ft,[e("button",{onClick:V,class:"confirm-btn"}," 확인 "),e("button",{onClick:t[5]||(t[5]=r=>v.value=!1),class:"cancel-btn"}," 취소 ")])])])):_("",!0)]))}},ht=F(mt,[["__scopeId","data-v-8bdb74f6"]]);export{ht as default};
