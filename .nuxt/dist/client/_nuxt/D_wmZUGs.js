import{_ as V,R as A,u as F,o as R,k as y,S as q,x as r,z as t,K as b,A as l,N as s,T as f,U as C,y as u,V as B}from"./CJyfR92X.js";import{u as _}from"./BWCIqgjc.js";import{u as I}from"./BvFTaLxf.js";const K={class:"container"},L={class:"header"},U={class:"user-info"},z={key:0,class:"loading"},N={key:1,class:"error"},E={key:2},H={class:"board-info"},O={class:"board-table"},W={class:"title-cell"},Y=["onClick"],j={key:0,class:"no-data"},G={key:1,class:"pagination"},J=["disabled"],Q=["disabled"],X=["onClick"],Z=["disabled"],tt=["disabled"],et={__name:"list",async setup(ot){let k,m;const P=A(),g=F(),$=_("user_name");R(()=>{_("auth_token").value||g.push("/")});const i=y(()=>parseInt(P.query.page)||1),{data:a,pending:w,error:v,refresh:st}=([k,m]=q(()=>I("/api/boards",{query:{page:i,limit:10},watch:[i]},"$_FlH-19PVU")),k=await k,m(),k),p=n=>{g.push({path:"/board/list",query:{page:n}})},T=()=>{g.push("/board/write")},x=n=>{g.push(`/board/${n}`)},M=async()=>{try{const n=await $fetch("/api/auth/logout",{method:"POST"});if(n.socialType==="2"||n.socialType==="kakao"){const d=n.kakaoApiKey,h="http://localhost:3000/api/auth/kakao/logout-callback";window.location.href=`https://kauth.kakao.com/oauth/logout?client_id=${d}&logout_redirect_uri=${h}`;return}const e=_("auth_token"),o=_("user_id"),c=_("user_name");e.value=null,o.value=null,c.value=null,g.push("/")}catch(n){console.error("Logout error:",n)}},S=y(()=>{if(!a.value||!a.value.pagination)return[];const n=a.value.pagination.totalPages,e=i.value,o=[];let c=Math.max(1,e-2),d=Math.min(n,e+2);e<=3&&(d=Math.min(5,n)),e>=n-2&&(c=Math.max(1,n-4));for(let h=c;h<=d;h++)o.push(h);return o}),D=n=>{if(!n)return"";const e=new Date(n),o=e.getFullYear(),c=String(e.getMonth()+1).padStart(2,"0"),d=String(e.getDate()).padStart(2,"0");return`${o}-${c}-${d}`};return(n,e)=>(u(),r("div",K,[t("div",L,[e[4]||(e[4]=t("h1",null,"게시판",-1)),t("div",U,[t("span",null,l(s($))+"님 환영합니다",1)])]),s(w)?(u(),r("div",z," 데이터를 불러오는 중... ")):s(v)?(u(),r("div",N," 오류가 발생했습니다: "+l(s(v).message),1)):s(a)&&s(a).success?(u(),r("div",E,[t("div",H," 전체 게시글: "+l(s(a).pagination.totalCount)+"개 ("+l(s(a).pagination.currentPage)+" / "+l(s(a).pagination.totalPages)+" 페이지) ",1),t("table",O,[e[5]||(e[5]=t("thead",null,[t("tr",null,[t("th",null,"번호"),t("th",null,"작성자"),t("th",null,"제목"),t("th",null,"조회수"),t("th",null,"등록일")])],-1)),t("tbody",null,[(u(!0),r(f,null,C(s(a).data,o=>(u(),r("tr",{key:o.bno},[t("td",null,l(o.rownum),1),t("td",null,l(o.writer),1),t("td",W,[t("a",{onClick:c=>x(o.bno),class:"title-link"},l(o.title),9,Y)]),t("td",null,l(o.hitno),1),t("td",null,l(D(o.regDate)),1)]))),128))])]),s(a).data.length===0?(u(),r("div",j," 등록된 게시글이 없습니다. ")):b("",!0),s(a).pagination.totalPages>1?(u(),r("div",G,[t("button",{onClick:e[0]||(e[0]=o=>p(1)),disabled:s(i)===1,class:"page-btn"}," 처음 ",8,J),t("button",{onClick:e[1]||(e[1]=o=>p(s(i)-1)),disabled:s(i)===1,class:"page-btn"}," 이전 ",8,Q),(u(!0),r(f,null,C(s(S),o=>(u(),r("button",{key:o,onClick:c=>p(o),class:B(["page-btn",{active:o===s(i)}])},l(o),11,X))),128)),t("button",{onClick:e[2]||(e[2]=o=>p(s(i)+1)),disabled:s(i)===s(a).pagination.totalPages,class:"page-btn"}," 다음 ",8,Z),t("button",{onClick:e[3]||(e[3]=o=>p(s(a).pagination.totalPages)),disabled:s(i)===s(a).pagination.totalPages,class:"page-btn"}," 마지막 ",8,tt)])):b("",!0),t("div",{class:"bottom-buttons"},[t("button",{onClick:T,class:"write-btn"}," 게시물 등록 "),t("button",{onClick:M,class:"logout-btn"}," 로그아웃 ")])])):b("",!0)]))}},it=V(et,[["__scopeId","data-v-0b5b8e02"]]);export{it as default};
